FROM amazonlinux:2

RUN yum update -y && yum upgrade -y

RUN curl -sL https://rpm.nodesource.com/setup_16.x | bash -
RUN curl -sL https://dl.yarnpkg.com/rpm/yarn.repo -o /etc/yum.repos.d/yarn.repo

RUN yum install -y nodejs awscli yarn git jq java-1.8.0-openjdk libappindicator-gtk3 liberation-fonts procps

COPY . /app
WORKDIR /app
COPY run-tests.sh /
RUN chmod +x /run-tests.sh
RUN cd /app && npm ci

ENTRYPOINT ["/run-tests.sh"]